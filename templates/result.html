<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prediction Result — PlantGuard AI</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Poppins:wght@600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Bootstrap & Tailwind -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    :root {
      --ink: #ffffff;
      --muted: #cde4d9;
      --white: #ffffff;
    }
    body { color: var(--white); }
    .meta { color: var(--muted) !important; }
    h2,h3,h4,h5,h6 { color: var(--white) !important; }
    .badge { background: rgba(255,255,255,0.15); color:#fff!important; }

    :root{
      --green-900:#0b3d2e; --green-800:#115941; --green-700:#166d4f;
      --green-500:#2ecc71; --green-400:#3dd087; --green-300:#6ee7b7;
      --ink:#0f172a; --muted:#94a3b8; --white:#fff;
      --glass:rgba(255,255,255,.08); --shadow:0 20px 60px rgba(0,0,0,.20);
    }
    html,body{
      height:100%; margin:0; color:var(--white);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,sans-serif;
      background: radial-gradient(1200px 600px at 20% -10%, #1b4332 0%, #0b2820 55%, #071a14 100%);
    }
    .nav{position:sticky;top:0;z-index:20;backdrop-filter:saturate(1.2) blur(10px);
      background:linear-gradient(0deg, rgba(5,20,14,.45), rgba(5,20,14,.45));
      border-bottom:1px solid rgba(255,255,255,.08)}
    .nav-inner{max-width:1100px;margin:0 auto;padding:14px 20px;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800}
    .brand i{color:var(--green-400)}
    .nav a{color:#e5f7ee;text-decoration:none;font-weight:600;opacity:.9}
    .nav a:hover{opacity:1;color:var(--green-300)}
    .nav ul{display:flex;gap:18px;list-style:none;margin:0;padding:0}

    .section{max-width:1100px;margin:0 auto;padding:56px 20px}
    .card{background:var(--glass);border:1px solid rgba(255,255,255,.14);border-radius:20px;
      box-shadow:var(--shadow);padding:24px}
    .grid{display:grid;grid-template-columns:1.05fr .95fr;gap:22px;align-items:center}
    .meta{font-size:13px;opacity:.9}

    .shot{width:100%;border-radius:14px;box-shadow:var(--shadow);aspect-ratio:4/3;object-fit:cover}

    .badge{display:inline-flex;align-items:center;gap:8px;font-weight:800;padding:6px 10px;border-radius:999px;
      background:rgba(46,204,113,.18);border:1px solid rgba(46,204,113,.35)}
    .ok{color:#22c55e}.warn{color:#fde047}.err{color:#f87171}
    .ring{--pct:0;width:132px;height:132px;border-radius:50%;display:grid;place-items:center;position:relative;
      background:conic-gradient(#22c55e calc(var(--pct)*1%), rgba(255,255,255,.18) 0)}
    .ring::after{content:"";position:absolute;inset:10px;border-radius:50%;background:rgba(0,0,0,.25);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.12)}
    .ring span{position:relative;font-weight:900}

    .btn{appearance:none;border:none;cursor:pointer;padding:12px 18px;border-radius:12px;font-weight:800;
      transition:transform .12s ease,box-shadow .2s ease,background .2s ease}
    .btn-primary{background:linear-gradient(180deg,var(--green-500),#22c55e);color:#04210f;box-shadow:0 15px 35px rgba(34,197,94,.35)}
    .btn-ghost{background:transparent;color:#eafff3;border:1px solid rgba(255,255,255,.18)}

    footer{padding:34px 16px;text-align:center;color:#d6ffe9;background:rgba(0,0,0,.2);border-top:1px solid rgba(255,255,255,.08)}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header class="nav">
    <div class="nav-inner">
      <a class="brand" href="/index"><i class="fa-solid fa-leaf"></i> PlantGuard&nbsp;AI</a>
      <nav>
        <ul>
          <li><a href="/index">Home</a></li>
          <li><a href="/history">History</a></li>
          <li><a href="/about">About</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <section class="section">
    <div class="card">
      <div id="empty" class="meta" style="display:none;text-align:center">
        No result found.
        <div style="margin-top:14px">
          <a class="btn btn-primary" href="/"><i class="fa-solid fa-bolt"></i> Try Again</a>
        </div>
      </div>

      <div id="content" class="grid" style="display:none">
        <div>
          <img id="resultImage" class="shot" alt="Leaf image"/>
        </div>
        <div>
          <h2 style="margin:0 0 6px">Prediction Result</h2>
          <div id="ts" class="meta"></div>

          <p class="meta" style="margin:18px 0 8px"><strong>Predicted Class:</strong></p>
          <div id="clsWrap" class="badge" style="margin-bottom:12px">
            <i class="fa-solid fa-circle-check"></i>
            <span id="cls">—</span>
          </div>

          <div style="display:flex;align-items:center;gap:16px;flex-wrap:wrap;margin:8px 0 4px">
            <div class="ring" id="ring"><span id="pct">0%</span></div>
            <div>
              <!-- <div style="font-weight:800;font-size:18px; color: var(--white)">Confidence</div> -->
              <div class="meta"><span id="pctText">0%</span></div>

              <div style="margin-top:18px">
                <h3 style="color:#fff">Severity</h3>
                <p id="severity" class="meta"></p>

                <h3 style="color:#fff; margin-top:12px">Soil Type</h3>
                <p id="soil" class="meta"></p>

                <h3 style="color:#fff; margin-top:12px">Weather Condition</h3>
                <p id="weather" class="meta"></p>

                <h3 style="color:#fff; margin-top:12px">Solution</h3>
                <p id="solution" class="meta"></p>

                <h3 style="color:#fff; margin-top:12px">Tips</h3>
                <p id="tips" class="meta"></p>
              </div>
            </div>
          </div>

          <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:18px">
            <a class="btn btn-primary" href="/"><i class="fa-solid fa-arrow-left"></i> Try Again</a>
            <button class="btn btn-ghost" id="clearBtn"><i class="fa-solid fa-eraser"></i> Clear result</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div style="opacity:.8;font-size:13px">© 2025 PlantGuard AI</div>
  </footer>

  <script>
    const result = JSON.parse(localStorage.getItem('pgai:result') || '{}');
    const emptyEl = document.getElementById('empty');
    const contentEl = document.getElementById('content');
    const imgEl = document.getElementById('resultImage');
    const clsEl = document.getElementById('cls');
    const clsWrap = document.getElementById('clsWrap');
    const ring = document.getElementById('ring');
    const pctEl = document.getElementById('pct');
    const pctText = document.getElementById('pctText');
    const tsEl = document.getElementById('ts');
    const clearBtn = document.getElementById('clearBtn');

    function showEmpty(){ emptyEl.style.display='block'; contentEl.style.display='none'; }
    function showContent(){ emptyEl.style.display='none'; contentEl.style.display='grid'; }

    if(result.image){
      imgEl.src = result.image;
      clsEl.textContent = result.prediction;
      tsEl.textContent = 'Generated locally • ' + new Date().toLocaleString();
      const pct = Math.max(0, Math.min(100, Number(result.confidencePct ?? 0)));
      ring.style.setProperty('--pct', pct);
      pctEl.textContent = pct.toFixed(0) + '%';
      pctText.textContent = pct.toFixed(2) + '%';

      const lower = String(result.prediction || '').toLowerCase();
      clsWrap.classList.remove('ok','warn','err');
      if(lower.includes('healthy')){ clsWrap.classList.add('ok'); }
      else if(lower.includes('stress')){ clsWrap.classList.add('warn'); }
      else { clsWrap.classList.add('err'); }

      // Extra fields
      document.getElementById('severity').textContent = result.severity || "—";
      document.getElementById('soil').textContent = result.soil || "—";
      document.getElementById('weather').textContent = result.weather || "—";
      document.getElementById('solution').textContent = result.solution || "—";
      document.getElementById('tips').textContent = result.tips || "—";

      clearBtn.addEventListener('click', () => {
        localStorage.removeItem('pgai:result');
        showEmpty();
      });

      showContent();
    } else {
      showEmpty();
    }
  </script>
</body>
</html>
